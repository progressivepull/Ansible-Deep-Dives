# 2.3 Ansible Inventory File

## What an inventory file really is
An inventory file is **Ansible’s address book**.

It answers three essential questions for Ansible:

* Who should I talk to?
* Where are they located?
* How do I log in?

Without this information, Ansible has no idea what computers exist or how to reach them.

## Which machines to manage
Ansible does not scan your network or guess hosts.

You must explicitly list:

1. Servers
2. VMs
3. Containers
4. Cloud instances
5. Eval / start agents

## Example:

```
[eval_agents]
agent1
agent2
```


## This tells Ansible:

“These are the machines I want you to manage.”

No inventory = no targets = nothing happens.

# How to connect to them

For each machine, Ansible must know how to reach it over the network.
This can be:

An IP address:
```
10.0.0.25
```

A hostname:
```
agent1.example.com
```

Or a friendly name mapped to a real address:
```
agent1 ansible_host=10.0.0.25
```

Ansible converts inventory entries into SSH connections like:

```
ssh ansible@10.0.0.25
```

## Default inventory location

Ansible looks for inventory in:

```
/etc/ansible/hosts
```

You can also use a custom file:
```
ansible -i inventory.ini all -m ping
```

## Simplest inventory (IP address)

```
[eval_agents]
10.0.0.25
```


### What this means:

* One group: eval_agents
* One host: 10.0.0.25
* Ansible will run:
```
ssh <user>@10.0.0.25
```

## Why Ansible cares about the user

Ansible runs SSH like this internally:
```
ssh ansible@10.0.0.25
````


So inventory must define:
```
ansible_user=ansible
```

## Best practice inventory (recommended)

Use a friendly name + ansible_host:

```
[eval_agents]
agent1 ansible_host=10.0.0.25 ansible_user=ansible
```

Benefits:
* Readable output
* Easy IP changes
* Clear SSH user

## Multiple hosts

```
[eval_agents]
agent1 ansible_host=10.0.0.25 ansible_user=ansible
agent2 ansible_host=10.0.0.26 ansible_user=ansible
```

## Using SSH keys in inventory

Ansible uses ~/.ssh/id_ed25519 automatically.

To specify a key:

```
[eval_agents]
agent1 ansible_host=10.0.0.25 ansible_user=ansible \
ansible_ssh_private_key_file=~/.ssh/github_ed25519
```

## Groups and children

```
[web]
agent1
agent2

[db]
agent3

[production:children]
web
db
```

### Why [production:children] exists

In Ansible, **:children** lets you create a parent group made up of other groups.  

This means:        
The production group contains all hosts from the web and db groups.    


# Run against all production hosts:

```
ansible production -m ping
```
## Inventory variables (group-wide)

```
[eval_agents:vars]
ansible_user=ansible
ansible_become=true
````


Now hosts can be simpler:
```
[eval_agents]
agent1 ansible_host=10.0.0.25
agent2 ansible_host=10.0.0.26
```

## [Context](./../context.md)