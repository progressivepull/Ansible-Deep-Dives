# 2.2 Check Connectivity

Before running any configuration or automation tasks, it is important to verify that Ansible can successfully communicate with all target hosts. The **connectivity check** ensures that your systems are reachable and ready to accept commands.

Ansible provides a built-in module called **`ping`** specifically for this purpose.

# SSH Key
SSH stands for Secure Shell. It is a **secure network protocol** used to log into remote computers and run commands safely over a network.

## What SSH does (in simple terms)

SSH lets you:

& ðŸ” Connect securely to another computer
* ðŸ–¥ï¸ Run commands remotely
ðŸ“ Copy files safely (with scp or rsync)
ðŸ”‘ Authenticate using SSH keys instead of passwords
ðŸ¤– Automate access (used by Ansible, CI/CD, servers)

All traffic is encrypted, so passwords, commands, and data cannot be read by attackers.

## Where SSH keys fit in Ansible

* Ansible control node: where you run ansible / ansible-playbook
* Managed nodes (agents/targets): hosts Ansible connects to
* Ansible uses SSH key-based auth (no passwords during runs)

---

## SSH keys (most important concept)

* Instead of passwords, SSH commonly uses key pairs:
    - Private key ðŸ”’
        * Stays on your machine
        * Never shared
    - Public key ðŸ”“
        * Copied to the server
        * Stored in ~/.ssh/authorized_keys

## Generate an SSH key on the Ansible control node

Run as the user that will execute Ansible:

``` bash
ssh-keygen -t ed25519 -C "ansible"
```

### Break down each part
* **ssh-keygen** - Starts the key creation process
* **-t ed25519** 
    - **-t** = type
    - **ed25519** = key algorithm

* **-C "ansible"**
    - **-C** = comment
    - **"ansible"** = label attached to the key

This comment:
* Helps you identify the key later
* Appears in authorized_keys and GitHub
* Does not affect security


Recommended answers:
* File: press Enter (default: ~/.ssh/id_ed25519)
* Passphrase:
    - Automation / eval: leave empty
    - Interactive use: set one

This creates:

* ~/.ssh/id_ed25519 â†’ private key
* ~/.ssh/id_ed25519.pub â†’ public key

âš ï¸ Never copy the private key to agents.

## Copy the public key to the agent(s)
### Option A â€“ Using ssh-copy-id (preferred)

Example:

```bash
ssh-copy-id ansible@10.0.0.25
```

### Option B â€“ Manual (if ssh-copy-id is unavailable)

On the control node:

```bash
cat ~/.ssh/id_ed25519.pub
```

On the agent:

```bash
mkdir -p ~/.ssh
chmod 700 ~/.ssh
echo "PASTE_PUBLIC_KEY_HERE" >> ~/.ssh/authorized_keys
chmod 600 ~/.ssh/authorized_keys
```

## One-liner (eval/start agent friendly)
Following line of code starts the SSH authentication agent in the current shell and then loads the GitHub SSH private key so it can be used for secure, password-less authentication.

### What the SSH agent is for

The SSH agent (ssh-agent) is used to:

* ðŸ”‘ Store your SSH private keys in memory
* ðŸ” Unlock keys once (enter passphrase one time)
* ðŸ¤– Provide keys automatically to SSH, Git, and Ansible
* ðŸš« Avoid typing passwords repeatedly

``` bash
eval "$(ssh-agent -s)" && ssh-add ~/.ssh/github_ed25519
```

## Verify SSH access (critical step)

From the control node:

``` bash
ssh ansible@10.0.0.25
```


You should log in without a password.


# Test the connectivity 

```bash
ansible all -m ping
```

## Understanding the Command

* **ansible** -  The Ansible command-line tool used for ad-hoc commands.
* **all** -  Targets all hosts listed in the inventory file.
* **-m ping** -  Uses the ping module (this is not ICMP ping).

## Sample Output

```
web1 | SUCCESS => {
    "changed": false,
    "ping": "pong"
}
```

## What "SUCCESS" and "pong" Mean

* **SUCCESS** - Ansible connected to the host and ran the module without errors.
* **"ping": "pong"** - A simple response confirming the host is ready to receive further tasks.

If a host does not respond, Ansible will display an error message explaining why (e.g., authentication failure, host unreachable, or missing Python).

## [Context](./../context.md)